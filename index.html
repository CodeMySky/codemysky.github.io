<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>CodeMySky&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="It&apos;s a blog to summarize my understanding in big data">
<meta property="og:type" content="website">
<meta property="og:title" content="CodeMySky&#39;s Blog">
<meta property="og:url" content="http://xiaohan.me/index.html">
<meta property="og:site_name" content="CodeMySky&#39;s Blog">
<meta property="og:description" content="It&apos;s a blog to summarize my understanding in big data">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CodeMySky&#39;s Blog">
<meta name="twitter:description" content="It&apos;s a blog to summarize my understanding in big data">
  
    <link rel="alternative" href="/atom.xml" title="CodeMySky&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/require-2.1.6,jquery-1.9.1.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="#" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Sean Han</a></h1>
		</hgroup>

		
		<p class="header-subtitle">My heart is in BIG DATA</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
							<li><a href="/2016/01/07/About-Me/">About Me</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/CodeMySky" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:hanxiaobow@gmail.com" title="mail">mail</a>
					        
								<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/codemysky" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/SQL/" style="font-size: 16.67px;">SQL</a> <a href="/tags/about-me/" style="font-size: 10px;">about-me</a> <a href="/tags/f-test/" style="font-size: 10px;">f-test</a> <a href="/tags/feature-extraction/" style="font-size: 10px;">feature-extraction</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hortonworks/" style="font-size: 10px;">hortonworks</a> <a href="/tags/introduction/" style="font-size: 10px;">introduction</a> <a href="/tags/knn/" style="font-size: 10px;">knn</a> <a href="/tags/mapreduce/" style="font-size: 16.67px;">mapreduce</a> <a href="/tags/predicting-poker-hands/" style="font-size: 20px;">predicting-poker-hands</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/random-forest/" style="font-size: 13.33px;">random-forest</a> <a href="/tags/sklearn/" style="font-size: 16.67px;">sklearn</a> <a href="/tags/statistics/" style="font-size: 10px;">statistics</a> <a href="/tags/t-test/" style="font-size: 10px;">t-test</a> <a href="/tags/z-test/" style="font-size: 10px;">z-test</a>
					</div>
				</section>
				

				

				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Sean Han</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/img/avatar.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Sean Han</h1>
			</hgroup>
			
			<p class="header-subtitle">My heart is in BIG DATA</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
					<li><a href="/2016/01/07/About-Me/">About Me</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/CodeMySky" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:hanxiaobow@gmail.com" title="mail">mail</a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/codemysky" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-SQL-Practice-3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/07/SQL-Practice-3/" class="article-date">
  	<time datetime="2018-05-08T03:44:31.000Z" itemprop="datePublished">2018-05-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/07/SQL-Practice-3/">SQL Practice 3</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SQL-Practice-3"><a href="#SQL-Practice-3" class="headerlink" title="SQL Practice 3"></a>SQL Practice 3</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><p>Given this table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Compare (</span><br><span class="line">    Numbers <span class="built_in">INT</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Write a SQL query that will return the maximum value from the “Numbers” column, without using a SQL aggregate like MAX or MIN.</p>
<h2 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h2><p>There are two ways to do that, first we can use a self join</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Numbers</span><br><span class="line"><span class="keyword">FROM</span> Compare</span><br><span class="line"><span class="keyword">WHERE</span> Numbers <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> Smaller.Numbers</span><br><span class="line">    <span class="keyword">FROM</span> Compare <span class="keyword">AS</span> Larger</span><br><span class="line">    <span class="keyword">JOIN</span> Compare <span class="keyword">AS</span> Smaller <span class="keyword">ON</span> Smaller.Numbers &lt; Larger.Numbers</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Second, which is easier, we can sort and limit the number of returned results.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Numbers</span><br><span class="line"><span class="keyword">FROM</span> Compare</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Numbers <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://www.programmerinterview.com/index.php/database-sql/find-maximum-value-without-using-aggregate/" target="_blank" rel="noopener">https://www.programmerinterview.com/index.php/database-sql/find-maximum-value-without-using-aggregate/</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-SQL-Practice-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/05/SQL-Practice-2/" class="article-date">
  	<time datetime="2018-05-05T21:48:06.000Z" itemprop="datePublished">2018-05-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/05/SQL-Practice-2/">SQL Practice 2</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SQL-Practice-2"><a href="#SQL-Practice-2" class="headerlink" title="SQL Practice 2"></a>SQL Practice 2</h1><h2 id="Table-Descirption"><a href="#Table-Descirption" class="headerlink" title="Table Descirption"></a>Table Descirption</h2><div class="table-container">
<table>
<thead>
<tr>
<th>User</th>
<th>UserHistory</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>user_id</td>
</tr>
<tr>
<td>name</td>
<td>date</td>
</tr>
<tr>
<td>phone_num</td>
<td>action</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h2><ul>
<li>Return the name, phone number and most recent date for any user that has logged in over the last 30 days. <ul>
<li>Every time a user logs in a new row is inserted into the UserHistor table with user_id, current date and action “logged_on”</li>
</ul>
</li>
<li>Determine which user_ids in the User table are not contained in the UserHistory table.<ul>
<li>assume the UserHistory table has a subset of the user_ids in User table.</li>
<li>Do not use the SQL MINUS statement.</li>
<li>The UserHistory table can have multiple entries for each user_id.</li>
</ul>
</li>
<li>Avoid using subqueries.</li>
</ul>
<h2 id="Answers"><a href="#Answers" class="headerlink" title="Answers"></a>Answers</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Return the name, phone number and most recent date for any user that has logged in over the last 30 days.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> u.name, u.phone_num, <span class="keyword">max</span>(uh.date) last_login_date</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">User</span> u <span class="keyword">JOIN</span> UserHistory uh</span><br><span class="line"><span class="keyword">ON</span> u.user_id = uh.user_id</span><br><span class="line"><span class="keyword">WHERE</span> uh.action = <span class="string">'logged_on'</span> <span class="keyword">AND</span> uh.date &gt;= <span class="built_in">date</span>(<span class="string">'now'</span>,<span class="string">'-30 day'</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> u.user_id, u.name, u.phone_num;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Determine which user_ids in the User table are not contained in the UserHistory table.</span></span><br><span class="line"><span class="keyword">SELECT</span> u.user_id</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">User</span> u <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> UserHistory uh</span><br><span class="line"><span class="keyword">ON</span> u.user_id = uh.user_id</span><br><span class="line"><span class="keyword">WHERE</span> uh.user_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://www.programmerinterview.com/index.php/database-sql/practice-interview-question-2/" target="_blank" rel="noopener">https://www.programmerinterview.com/index.php/database-sql/practice-interview-question-2/</a></li>
</ul>
<h2 id="Preparation-Statements"><a href="#Preparation-Statements" class="headerlink" title="Preparation Statements"></a>Preparation Statements</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">User</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">User</span> (</span><br><span class="line">    user_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>,</span><br><span class="line">    phone_num <span class="built_in">varchar</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">User</span> (<span class="string">'user_id'</span>, <span class="string">'name'</span>, <span class="string">'phone_num'</span>)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span> , <span class="string">'Abe'</span>    , <span class="string">'111'</span> ),</span><br><span class="line">(<span class="number">2</span> , <span class="string">'Bob'</span>    , <span class="string">'222'</span> ),</span><br><span class="line">(<span class="number">5</span> , <span class="string">'Chris'</span>  , <span class="string">'333'</span> ),</span><br><span class="line">(<span class="number">7</span> , <span class="string">'Dan'</span>    , <span class="string">'444'</span> ),</span><br><span class="line">(<span class="number">8</span> , <span class="string">'Ken'</span>    , <span class="string">'555'</span> ),</span><br><span class="line">(<span class="number">11</span>, <span class="string">'Joe'</span>    , <span class="string">'666'</span> );</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> UserHistory;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> UserHistory (</span><br><span class="line">    user_id <span class="built_in">int</span>,</span><br><span class="line">    <span class="built_in">date</span> <span class="built_in">varchar</span>,</span><br><span class="line">    <span class="keyword">action</span> <span class="built_in">varchar</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> UserHistory (<span class="string">'user_id'</span>, <span class="string">'date'</span>, <span class="string">'action'</span>)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">'2018-05-05'</span>, <span class="string">'logged_on'</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">'2017-12-01'</span>, <span class="string">'logged_on'</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">'2017-12-01'</span>, <span class="string">'logged_on'</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">'2018-05-05'</span>, <span class="string">'logged_on'</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">'2018-05-05'</span>, <span class="string">'logged_off'</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">'2018-05-01'</span>, <span class="string">'logged_on'</span>),</span><br><span class="line">(<span class="number">8</span>, <span class="string">'2018-05-05'</span>, <span class="string">'logged_on'</span>);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-SQL-Practice-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/03/SQL-Practice-1/" class="article-date">
  	<time datetime="2018-05-04T05:12:00.000Z" itemprop="datePublished">2018-05-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/03/SQL-Practice-1/">SQL Practice 1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SQL-Practice-1"><a href="#SQL-Practice-1" class="headerlink" title="SQL Practice 1"></a>SQL Practice 1</h1><h2 id="Table-Description"><a href="#Table-Description" class="headerlink" title="Table Description"></a>Table Description</h2><div class="table-container">
<table>
<thead>
<tr>
<th>Salesperson</th>
<th>Customer</th>
<th>Orders</th>
<th>highAchiever</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>ID</td>
<td>Number</td>
<td>Name</td>
</tr>
<tr>
<td>Name</td>
<td>Name</td>
<td>Order_date</td>
<td>Age</td>
</tr>
<tr>
<td>Age</td>
<td>City</td>
<td>Cust_id</td>
<td></td>
</tr>
<tr>
<td>Salary</td>
<td>Industry</td>
<td>Salesperson_id</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>Amount</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h2><ul>
<li>The names of all salespeople that have an order with Samsonic.</li>
<li>The names of all salespeople that do not have any order with Samsonic.</li>
<li>The name of all salespeople that have 2 or more orders.</li>
<li>Write a SQL statement to insert rows into a table called highAchiever(Name, Age), where a salesperson must have a salary of 100,000 or greater to be included in the table.</li>
</ul>
<h2 id="Answers"><a href="#Answers" class="headerlink" title="Answers"></a>Answers</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- The names of all salespeople that have an order with Samsonic.</span></span><br><span class="line"><span class="keyword">SELECT</span> sp.Name</span><br><span class="line"><span class="keyword">FROM</span> Salesperson sp</span><br><span class="line"><span class="keyword">JOIN</span> Orders o <span class="keyword">ON</span> sp.ID = o.salesperson_id</span><br><span class="line"><span class="keyword">JOIN</span> Customer c <span class="keyword">on</span> c.ID = o.cust_id</span><br><span class="line"><span class="keyword">WHERE</span> c.Name = <span class="string">'Samsonic'</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- The names of all salespeople that do not have any order with Samsonic.</span></span><br><span class="line"><span class="keyword">SELECT</span> sp.Name</span><br><span class="line"><span class="keyword">FROM</span> Salesperson sp</span><br><span class="line"><span class="keyword">WHERE</span> sp.ID <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> o.salesperson_id</span><br><span class="line">    <span class="keyword">FROM</span> Orders o <span class="keyword">JOIN</span> Customer c <span class="keyword">ON</span> o.cust_id = c.ID</span><br><span class="line">    <span class="keyword">WHERE</span> c.Name == <span class="string">'Samsonic'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- The name of all salespeople that have 2 or more orders</span></span><br><span class="line"><span class="keyword">SELECT</span> sp.Name</span><br><span class="line"><span class="keyword">FROM</span> Salesperson sp</span><br><span class="line"><span class="keyword">JOIN</span> Orders o <span class="keyword">ON</span> sp.ID = o.salesperson_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> o.salesperson_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Write a SQL statement to insert rows into a table called highAchiever(Name, Age), where a salesperson must have a salary of 100,000 or greater to be included in the table.</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> highAchiever (<span class="keyword">Name</span>, Age)</span><br><span class="line">    <span class="keyword">SELECT</span> sp.Name, sp.Age</span><br><span class="line">    <span class="keyword">FROM</span> Salesperson sp</span><br><span class="line">    <span class="keyword">WHERE</span> sp.Salary &gt;= <span class="number">100000</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h2 id="Advanced-Questions"><a href="#Advanced-Questions" class="headerlink" title="Advanced Questions"></a>Advanced Questions</h2><h3 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h3><p>We want to retrieve the names of all salespeople that have more than 1 order from the tables above. You can assume that each salesperson only has one ID.</p>
<p>If that is the case, then what (if anything) is wrong with the following SQL?:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></span><br><span class="line"><span class="keyword">FROM</span> Orders, Salesperson</span><br><span class="line"><span class="keyword">WHERE</span> Orders.salesperson_id = Salesperson.ID</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> salesperson_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>( salesperson_id ) &gt; <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h3><p><code>Name</code> is not included in the <code>GROUP BY</code> clause.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></span><br><span class="line"><span class="keyword">FROM</span> Orders, Salesperson</span><br><span class="line"><span class="keyword">WHERE</span> Orders.salesperson_id = Salesperson.ID</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> salesperson_id, <span class="keyword">Name</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>( salesperson_id ) &gt; <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h3><p>Find the largest order amount for each salesperson and the associated order number, along with the customer to whom that order belongs to. </p>
<h3 id="Answer-2"><a href="#Answer-2" class="headerlink" title="Answer 2"></a>Answer 2</h3><p>We do this in two steps.</p>
<p>First, we selected out sales person and top orders.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salesperson_id, <span class="keyword">MAX</span>( Amount ) <span class="keyword">AS</span> MaxOrder</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> salesperson_id</span><br></pre></td></tr></table></figure>
<p>Then we match the result with other table to generate final result.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Salesperson.ID, Salesperson.Name, <span class="built_in">Number</span> <span class="keyword">AS</span> OrderNumber, Orders.Amount</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">JOIN</span> Salesperson </span><br><span class="line"><span class="keyword">ON</span> Salesperson.ID = Orders.salesperson_id</span><br><span class="line"><span class="keyword">JOIN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> salesperson_id, <span class="keyword">MAX</span>( Amount ) <span class="keyword">AS</span> MaxOrder</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> salesperson_id</span><br><span class="line">) <span class="keyword">AS</span> TopOrders</span><br><span class="line"><span class="keyword">ON</span> TopOrders.salesperson_id = Salesperson.ID <span class="keyword">AND</span> Orders.Amount = TopOrders.MaxOrder</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Salesperson.ID, Orders.Amount;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://www.programmerinterview.com/index.php/database-sql/practice-interview-question-1/" target="_blank" rel="noopener">http://www.programmerinterview.com/index.php/database-sql/practice-interview-question-1/</a></li>
<li><a href="https://www.programmerinterview.com/index.php/database-sql/advanced-sql-interview-questions-and-answers/" target="_blank" rel="noopener">https://www.programmerinterview.com/index.php/database-sql/advanced-sql-interview-questions-and-answers/</a></li>
</ul>
<h3 id="Salesperson"><a href="#Salesperson" class="headerlink" title="Salesperson"></a>Salesperson</h3><div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Age</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Abe</td>
<td>61</td>
<td>140000</td>
</tr>
<tr>
<td>2</td>
<td>Bob</td>
<td>34</td>
<td>44000</td>
</tr>
<tr>
<td>5</td>
<td>Chris</td>
<td>34</td>
<td>40000</td>
</tr>
<tr>
<td>7</td>
<td>Dan</td>
<td>41</td>
<td>52000</td>
</tr>
<tr>
<td>8</td>
<td>Ken</td>
<td>57</td>
<td>115000</td>
</tr>
<tr>
<td>11</td>
<td>Joe</td>
<td>38</td>
<td>38000</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Customer"><a href="#Customer" class="headerlink" title="Customer"></a>Customer</h3><div class="table-container">
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>City</th>
<th>Industry</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>Samsonic</td>
<td>pleasant</td>
<td>J</td>
</tr>
<tr>
<td>6</td>
<td>Panasung</td>
<td>oaktown</td>
<td>J</td>
</tr>
<tr>
<td>7</td>
<td>Samony</td>
<td>jackson</td>
<td>B</td>
</tr>
<tr>
<td>9</td>
<td>Orange</td>
<td>Jackson</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Orders"><a href="#Orders" class="headerlink" title="Orders"></a>Orders</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Number</th>
<th>order_date</th>
<th>cust_id</th>
<th>salesperson_id</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>8/2/96</td>
<td>4</td>
<td>2</td>
<td>540</td>
</tr>
<tr>
<td>20</td>
<td>1/30/99</td>
<td>4</td>
<td>8</td>
<td>1800</td>
</tr>
<tr>
<td>30</td>
<td>7/14/95</td>
<td>9</td>
<td>1</td>
<td>460</td>
</tr>
<tr>
<td>40</td>
<td>1/29/98</td>
<td>7</td>
<td>2</td>
<td>2400</td>
</tr>
<tr>
<td>50</td>
<td>2/3/98</td>
<td>6</td>
<td>7</td>
<td>600</td>
</tr>
<tr>
<td>60</td>
<td>3/2/98</td>
<td>6</td>
<td>7</td>
<td>720</td>
</tr>
<tr>
<td>70</td>
<td>5/6/98</td>
<td>9</td>
<td>7</td>
<td>150</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Preparation-Statements"><a href="#Preparation-Statements" class="headerlink" title="Preparation Statements"></a>Preparation Statements</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Salesperson (</span><br><span class="line">    <span class="keyword">ID</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">Name</span> <span class="built_in">varchar</span>,</span><br><span class="line">    Age <span class="built_in">int</span>,</span><br><span class="line">    Salary <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Salesperson (<span class="string">'ID'</span>, <span class="string">'Name'</span>, <span class="string">'Age'</span>, <span class="string">'Salary'</span>)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span> , <span class="string">'Abe'</span>    ,<span class="number">61</span>, <span class="number">140000</span> ),</span><br><span class="line">(<span class="number">2</span> , <span class="string">'Bob'</span>    ,<span class="number">34</span>, <span class="number">44000</span>  ),</span><br><span class="line">(<span class="number">5</span> , <span class="string">'Chris'</span>  ,<span class="number">34</span>, <span class="number">40000</span>  ),</span><br><span class="line">(<span class="number">7</span> , <span class="string">'Dan'</span>    ,<span class="number">41</span>, <span class="number">52000</span>  ),</span><br><span class="line">(<span class="number">8</span> , <span class="string">'Ken'</span>    ,<span class="number">57</span>, <span class="number">115000</span> ),</span><br><span class="line">(<span class="number">11</span>, <span class="string">'Joe'</span>    ,<span class="number">38</span>, <span class="number">38000</span>  );</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Customer (</span><br><span class="line">    <span class="keyword">ID</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">Name</span> <span class="built_in">varchar</span>,</span><br><span class="line">    City <span class="built_in">varchar</span>,</span><br><span class="line">    Industry <span class="built_in">varchar</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customer (<span class="string">'ID'</span>, <span class="string">'Name'</span>, <span class="string">'City'</span>, <span class="string">'Industry'</span>)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">4</span>, <span class="string">'Samsonic'</span>, <span class="string">'pleasant'</span>, <span class="string">'J'</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">'Panasung'</span>, <span class="string">'oaktown'</span> , <span class="string">'J'</span>),</span><br><span class="line">(<span class="number">7</span>, <span class="string">'Samony'</span>,   <span class="string">'jackson'</span> , <span class="string">'B'</span>),</span><br><span class="line">(<span class="number">9</span>, <span class="string">'Orange'</span>,   <span class="string">'Jackson'</span> , <span class="string">'B'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (</span><br><span class="line">    <span class="built_in">Number</span> <span class="built_in">int</span>,</span><br><span class="line">    Order_date <span class="built_in">varchar</span>,</span><br><span class="line">    Cust_id <span class="built_in">int</span>,</span><br><span class="line">    Salesperson_id <span class="built_in">int</span>,</span><br><span class="line">    Amount <span class="built_in">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Orders (<span class="string">'Number'</span>, <span class="string">'Order_date'</span>, <span class="string">'Cust_id'</span>, <span class="string">'Salesperson_id'</span>, <span class="string">'Amount'</span>)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">10</span>, <span class="string">'8/2/96'</span>,  <span class="number">4</span>, <span class="number">2</span>, <span class="number">540</span> ),</span><br><span class="line">(<span class="number">20</span>, <span class="string">'1/30/99'</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1800</span>),</span><br><span class="line">(<span class="number">30</span>, <span class="string">'7/14/95'</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">460</span> ),</span><br><span class="line">(<span class="number">40</span>, <span class="string">'1/29/98'</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">2400</span>),</span><br><span class="line">(<span class="number">50</span>, <span class="string">'2/3/98'</span>,  <span class="number">6</span>, <span class="number">7</span>, <span class="number">600</span> ),</span><br><span class="line">(<span class="number">60</span>, <span class="string">'3/2/98'</span>,  <span class="number">6</span>, <span class="number">7</span>, <span class="number">720</span> ),</span><br><span class="line">(<span class="number">70</span>, <span class="string">'5/6/98'</span>,  <span class="number">9</span>, <span class="number">7</span>, <span class="number">150</span> );</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> highAchiever (</span><br><span class="line">    <span class="keyword">Name</span> <span class="built_in">varchar</span>,</span><br><span class="line">    Age <span class="built_in">int</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MapReduce-Train-Random-Forest-with-Python-and-Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/19/MapReduce-Train-Random-Forest-with-Python-and-Hadoop/" class="article-date">
  	<time datetime="2017-02-19T19:53:14.000Z" itemprop="datePublished">2017-02-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/19/MapReduce-Train-Random-Forest-with-Python-and-Hadoop/">MapReduce: Train Random Forest with Python and Hadoop</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Install-Hortonworks-Sandbox"><a href="#Install-Hortonworks-Sandbox" class="headerlink" title="Install Hortonworks Sandbox"></a>Install Hortonworks Sandbox</h2><p>Hortonworks sandbox provides a nice playground for hadoop beginners to test their big data application.</p>
<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener">Windows and Linux: Install Virtual Box</a></li>
<li><a href="https://www.vmware.com/go/downloadfusion" target="_blank" rel="noopener">MAC: Install VMWare Fusion</a></li>
<li><a href="https://hortonworks.com/downloads/" target="_blank" rel="noopener">Install Hortonworks Sandbox</a></li>
<li><a href="http://hortonworks.com/hadoop-tutorial/learning-the-ropes-of-the-hortonworks-sandbox/" target="_blank" rel="noopener">Follow tutorial to setup environment and password</a></li>
<li>The python shipped with hortonworks is Python 2.6, which is really old.</li>
<li>Install Anaconda3 to upgrade python to Python 3.6 to default location /root/anaconda3</li>
<li><a href="https://www.continuum.io/downloads" target="_blank" rel="noopener">Anaconda</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Anaconda3-XXX-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<h2 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/root/anaconda3/bin/python</span></span><br><span class="line"><span class="comment"># Filename: forest_mapper.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DecisionNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, depth = <span class="number">0</span>, max_depth = <span class="number">-1</span>)</span>:</span></span><br><span class="line">        self._left_child = <span class="keyword">None</span></span><br><span class="line">        self._right_child = <span class="keyword">None</span></span><br><span class="line">        self._depth = depth</span><br><span class="line">        self._max_depth = max_depth</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_divide</span><span class="params">(self, data_set, column, condition)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(condition, str):</span><br><span class="line">            part_a = data_set[data_set[column] == condition]</span><br><span class="line">            part_b = data_set[data_set[column] != condition]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            part_a = data_set[data_set[column] &gt;= condition]</span><br><span class="line">            part_b = data_set[data_set[column] &lt; condition]</span><br><span class="line">        <span class="keyword">return</span> part_a, part_b</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_entropy</span><span class="params">(self, labels)</span>:</span></span><br><span class="line">        counts = labels.value_counts()</span><br><span class="line">        total = sum(counts)</span><br><span class="line">        entropy = -counts.map(<span class="keyword">lambda</span> c: (c/total) * math.log2(c/total)).sum()</span><br><span class="line">        <span class="keyword">return</span> entropy</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_entropy_sum</span><span class="params">(self, set_a, set_b)</span>:</span></span><br><span class="line">        size_a = set_a.shape[<span class="number">0</span>]</span><br><span class="line">        size_b = set_b.shape[<span class="number">0</span>]</span><br><span class="line">        total = size_a + size_b</span><br><span class="line">        total_entropy = size_a / total * self._entropy(set_a) + size_b / total * self._entropy(set_b)</span><br><span class="line">        <span class="keyword">return</span> total_entropy</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_information_gain</span><span class="params">(self,data_set, column, condition)</span>:</span></span><br><span class="line">        set_a, set_b = self._divide(data_set, column, condition)</span><br><span class="line">        gain = self._entropy(data_set.iloc[:, <span class="number">-1</span>]) - self._entropy_sum(set_a.iloc[:,<span class="number">-1</span>], set_b.iloc[:,<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">return</span> gain</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, data_set, selected_features = None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> selected_features <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            columns = data_set.columns.values.tolist()</span><br><span class="line">            selected_features = columns[:<span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        best_gain = <span class="number">0</span></span><br><span class="line">        best_split_col = <span class="keyword">None</span></span><br><span class="line">        best_split_value = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> column_name <span class="keyword">in</span> selected_features:</span><br><span class="line">            current_column = data_set[column_name]</span><br><span class="line">            unique_values = current_column.unique().tolist()</span><br><span class="line">            <span class="keyword">for</span> value <span class="keyword">in</span> unique_values:</span><br><span class="line">                gain = self._information_gain(data_set, column_name, value)</span><br><span class="line">                <span class="keyword">if</span> gain &gt; best_gain:</span><br><span class="line">                    best_gain = gain</span><br><span class="line">                    best_split_col = column_name</span><br><span class="line">                    best_split_value = value</span><br><span class="line">                    </span><br><span class="line">        self._best_split_col = best_split_col</span><br><span class="line">        self._best_split_value = best_split_value</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> best_gain &gt; <span class="number">0</span> <span class="keyword">and</span> (self._max_depth == <span class="number">-1</span> <span class="keyword">or</span> self._depth &lt; self._max_depth):</span><br><span class="line">            set_a, set_b = self._divide(data_set, best_split_col, best_split_value)</span><br><span class="line">            self._left_child = DecisionNode(self._depth + <span class="number">1</span>, self._max_depth)</span><br><span class="line">            self._left_child.fit(set_a)</span><br><span class="line">            </span><br><span class="line">            self._right_child = DecisionNode(self._depth + <span class="number">1</span>, self._max_depth)</span><br><span class="line">            self._right_child.fit(set_b)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self._leaf_value = data_set.iloc[:,<span class="number">-1</span>].unique()[<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict_single</span><span class="params">(self, record)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self._left_child <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">and</span> self._right_child <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self._leaf_value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> isinstance(self._best_split_value, str):</span><br><span class="line">                go_left = record[self._best_split_col] == self._best_split_value</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                go_left = record[self._best_split_col] &gt;= self._best_split_value</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> go_left:</span><br><span class="line">                <span class="keyword">return</span> self._left_child.predict_single(record)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> self._right_child.predict_single(record)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, data_set)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> data_set.apply(self.predict_single, axis=<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        tree_str = <span class="string">'\t'</span> * self._depth + <span class="string">'&gt;'</span></span><br><span class="line">        <span class="keyword">if</span> self._left_child == <span class="keyword">None</span> <span class="keyword">and</span> self._right_child == <span class="keyword">None</span>:</span><br><span class="line">            tree_str += <span class="string">'LEAF: &#123;&#125;\n'</span>.format(self._leaf_value)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tree_str += <span class="string">"Split &#123;&#125; on &#123;&#125;\n"</span>.format(self._best_split_col, self._best_split_value)</span><br><span class="line">            tree_str += str(self._left_child)</span><br><span class="line">            tree_str += str(self._right_child)</span><br><span class="line">        <span class="keyword">return</span> tree_str</span><br><span class="line"></span><br><span class="line"><span class="comment"># load dataset</span></span><br><span class="line">data_set =  pd.read_csv(<span class="string">'iris.data'</span>,  names=[<span class="string">'sepal_length'</span>, <span class="string">'sepal_width'</span>, <span class="string">'petal_length'</span>, <span class="string">'petal_width'</span>, <span class="string">'iris_type'</span>])</span><br><span class="line"><span class="comment"># input comes from STDIN (standard input)</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    <span class="comment"># remove leading and trailing whitespace</span></span><br><span class="line">    line = line.strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># generate a tree</span></span><br><span class="line">    selected_rows = np.random.choice(data_set.shape[<span class="number">0</span>] - <span class="number">1</span>, data_set.shape[<span class="number">0</span>] / <span class="number">3</span>)</span><br><span class="line">    selected_features = np.random.choice(data_set.columns.tolist()[:<span class="number">-1</span>], np.ceil(np.sqrt(data_set.shape[<span class="number">1</span>])), replace=<span class="keyword">False</span>)</span><br><span class="line">    decision_tree = DecisionNode()</span><br><span class="line">    decision_tree.fit(data_set.iloc[selected_rows,:], selected_features)</span><br><span class="line">    print(<span class="string">'&#123;&#125;'</span>.format(pickle.dumps(decision_tree)))</span><br></pre></td></tr></table></figure>
<h2 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h2><p>Code here is a modified version of reducer in <a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="noopener">this blog</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/root/anaconda3/bin/python</span></span><br><span class="line"><span class="comment"># Filename: forest_reducer.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># input comes from STDIN</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    <span class="comment"># remove leading and trailing whitespace</span></span><br><span class="line">    line = line.strip()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'&#123;&#125;'</span>.format(line))</span><br></pre></td></tr></table></figure>
<h2 id="Test-Mapper-and-Reducer"><a href="#Test-Mapper-and-Reducer" class="headerlink" title="Test Mapper and Reducer"></a>Test Mapper and Reducer</h2><ul>
<li>Generate a forest_number.txt contains <code>n</code> line, where <code>n</code> is the number of trees you want to generate. Because we generate one tree per line, each mapper loads training data (iris) once, and randomly select feature and records for each tree.</li>
<li>If you want to generate 5 trees, forest_number.txt contains</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Make mapper and reducer executable <figure class="highlight plain"><figcaption><span>+x forest_mapper.py forest_reducer.py```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- **Test your mapper and reducer locally** ```cat forest_number.txt | forest_mapper.py | sort | forest_reducer.py  ``` , this step is important because hadoop doesn&apos;t show the exact error output from python, so it&apos;s hard to debug python in hadoop.</span><br><span class="line">- Upload the txt into hdfs under `/demo/data`, using [Ambari file view](http://localhost:8080/#/main/views/FILES/1.0.0/AUTO_FILES_INSTANCE)</span><br><span class="line">- Test mapper and reducer using hadoop</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">hadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -file /root/forest_mapper.py -mapper forest_mapper.py -file /root/forest_reducer.py -reducer forest_reducer.py -file /root/iris.data -input /demo/data/forest_number.txt -output /demo/outputhadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -file /root/forest_mapper.py -mapper forest_mapper.py -file /root/forest_reducer.py -reducer forest_reducer.py -file /root/iris.data -input /demo/data/forest_number.txt -output /demo/output</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>After this step, generated trees should be stored in <code>/demo/output</code></p>
</li>
<li>Clean up the output folder after the experiment, this step is important because hadoop will not overwrite existing folder</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rm -r /demo/output</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Secret-Mission-Spy-in-the-Dark" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/22/Secret-Mission-Spy-in-the-Dark/" class="article-date">
  	<time datetime="2016-02-23T00:46:41.000Z" itemprop="datePublished">2016-02-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/22/Secret-Mission-Spy-in-the-Dark/">Secret Mission: Spy in the Dark</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Our hero, Tom, get a secret mission.<br>He need to determine what is a princess doing, to get the routine of her.<br>The data set looks like this.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/knn/">knn</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/">mapreduce</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Introduction-to-Inferential-Statistics" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/22/Introduction-to-Inferential-Statistics/" class="article-date">
  	<time datetime="2016-02-22T23:24:01.000Z" itemprop="datePublished">2016-02-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/22/Introduction-to-Inferential-Statistics/">Introduction to Inferential Statistics</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>As a data scientist, we have different methods to treat the data. But how can we know the whether our methods are doing good or our model is just guessing.<br>We can use a serious of test to decide whether our model is good or not including z-test, t-test and f-test.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/f-test/">f-test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/statistics/">statistics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/t-test/">t-test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/z-test/">z-test</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/02/22/Introduction-to-Inferential-Statistics/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MapReduce-Run-Word-Count-with-Python-and-Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/MapReduce-Run-Word-Count-with-Python-and-Hadoop/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/MapReduce-Run-Word-Count-with-Python-and-Hadoop/">MapReduce: Run Word Count with Python and Hadoop</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Install-Hortonworks-Sandbox"><a href="#Install-Hortonworks-Sandbox" class="headerlink" title="Install Hortonworks Sandbox"></a>Install Hortonworks Sandbox</h2><p>Hortonworks sandbox provides a nice playground for hadoop beginners to test their big data application.</p>
<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener">Windows and Linux: Install Virtual Box</a></li>
<li><a href="https://www.vmware.com/go/downloadfusion" target="_blank" rel="noopener">MAC: Install VMWare Fusion</a></li>
<li><a href="https://hortonworks.com/downloads/" target="_blank" rel="noopener">Install Hortonworks Sandbox</a></li>
<li><a href="http://hortonworks.com/hadoop-tutorial/learning-the-ropes-of-the-hortonworks-sandbox/" target="_blank" rel="noopener">Follow tutorial to setup environment and password</a></li>
<li>The python shipped with hortonworks is Python 2.6, which is really old.</li>
<li>Install Anaconda3 to upgrade python to Python 3.6 to default location /root/anaconda3</li>
<li><a href="https://www.continuum.io/downloads" target="_blank" rel="noopener">Anaconda</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Anaconda3-XXX-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<h2 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h2><p>Code here is a modified version of mapper in <a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="noopener">this blog</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/root/anaconda3/bin/python</span></span><br><span class="line"><span class="comment"># Filename: word_count_mapper.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># input comes from STDIN (standard input)</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    <span class="comment"># remove leading and trailing whitespace</span></span><br><span class="line">    line = line.strip()</span><br><span class="line">    <span class="comment"># split the line into words</span></span><br><span class="line">    words = line.split()</span><br><span class="line">    <span class="comment"># increase counters</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="comment"># write the results to STDOUT (standard output);</span></span><br><span class="line">        <span class="comment"># what we output here will be the input for the</span></span><br><span class="line">        <span class="comment"># Reduce step, i.e. the input for reducer.py</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># tab-delimited; the trivial word count is 1</span></span><br><span class="line">        print(<span class="string">'&#123;&#125;\t&#123;&#125;'</span>.format(word, <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h2 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h2><p>Code here is a modified version of reducer in <a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="noopener">this blog</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/root/anaconda3/bin/python</span></span><br><span class="line"><span class="comment"># Filename: word_count_reducer.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">current_word = <span class="keyword">None</span></span><br><span class="line">current_count = <span class="number">0</span></span><br><span class="line">word = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># input comes from STDIN</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">    <span class="comment"># remove leading and trailing whitespace</span></span><br><span class="line">    line = line.strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># parse the input we got from mapper.py</span></span><br><span class="line">    word, count = line.split(<span class="string">'\t'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># convert count (currently a string) to int</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        count = int(count)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="comment"># count was not a number, so silently</span></span><br><span class="line">        <span class="comment"># ignore/discard this line</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># this IF-switch only works because Hadoop sorts map output</span></span><br><span class="line">    <span class="comment"># by key (here: word) before it is passed to the reducer</span></span><br><span class="line">    <span class="keyword">if</span> current_word == word:</span><br><span class="line">        current_count += count</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> current_word:</span><br><span class="line">            <span class="comment"># write result to STDOUT</span></span><br><span class="line">            print(<span class="string">'&#123;&#125;\t&#123;&#125;'</span>.format(current_word, current_count))</span><br><span class="line">        current_count = count</span><br><span class="line">        current_word = word</span><br><span class="line"></span><br><span class="line"><span class="comment"># do not forget to output the last word if needed!</span></span><br><span class="line"><span class="keyword">if</span> current_word == word:</span><br><span class="line">    print(<span class="string">'&#123;&#125;\t&#123;&#125;'</span>.format(current_word, current_count))</span><br></pre></td></tr></table></figure>
<h2 id="Test-Mapper-and-Reducer"><a href="#Test-Mapper-and-Reducer" class="headerlink" title="Test Mapper and Reducer"></a>Test Mapper and Reducer</h2><ul>
<li>Download <a href="https://ocw.mit.edu/ans7870/6/6.006/s08/lecturenotes/files/t8.shakespeare.txt" target="_blank" rel="noopener">Shakespeare</a> </li>
<li><p>Scp the txt into virtual machine, you can use scp on Mac and Linux <figure class="highlight plain"><figcaption><span>-P 2222 t8.shakespeare.txt root@localhost:/root/ ```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- You can use [WinSCP](https://winscp.net/eng/download.php) to put the txt into virtual maxhine</span><br><span class="line">- Make mapper and reducer executable ```chmod +x word_count_mapper.py word_count_reducer.py</span><br></pre></td></tr></table></figure></p>
</li>
<li><p><strong>Test your mapper and reducer locally</strong> <figure class="highlight plain"><figcaption><span>t8.shakespear.txt | word_count_mapper.py | sort | word_count_reducer.py  ``` , this step is important because hadoop doesn't show the exact error output from python, so it's hard to debug python in hadoop.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- Upload the txt into hdfs under ```/demo/data```, using [Ambari file view](http://localhost:8080/#/main/views/FILES/1.0.0/AUTO_FILES_INSTANCE)</span><br><span class="line">- Test mapper and reducer using hadoop</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">hadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -file /root/mapper.py -mapper mapper.py -file /root/reducer.py -reducer reducer.py -input /demo/data/t8.shakespeare.txt -output /demo/output</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>Clean up the output folder after the experiment, this step is important because hadoop will not overwrite existing folder</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rm -r /demo/output</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="noopener">http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hortonworks/">hortonworks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/">mapreduce</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Escaping-Predicting-Poker-Hands-Part-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/">Escaping: Predicting Poker Hands, Part 1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Our hero Tom, who used to be a data scientist, went on an adventure, predicting poker hands. He wanted to share his experience here and he hopes it will be helpful for you to learn how to explore the big data world.</p>
<p>In this beginner’s summary, Tom will first talk about some basic concepts of big data, including training sets, test sets. Tom then will talk about a random forest model and how to rate models in general. In the end, Tom will show why features are important to generate accurate results.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/predicting-poker-hands/">predicting-poker-hands</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-How-to-Create-a-Blog-Using-Hexo" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/How-to-Create-a-Blog-Using-Hexo/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/How-to-Create-a-Blog-Using-Hexo/">How to Create a Blog Using Hexo</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://hexo.io" title="Hexo" target="_blank" rel="noopener">Hexo</a> is a fast, simple &amp; powerful blog framework built on Node.js. By using Hexo, I avoided a lot of frustration building a blog while concentrate myself on blog.</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/">Hexo</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/How-to-Create-a-Blog-Using-Hexo/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Mapreduce-Start-from-Word-Count" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Mapreduce-Start-from-Word-Count/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Mapreduce-Start-from-Word-Count/">Mapreduce: Start from Word Count</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>As a fan of big data, the most basic concept of big data is hadoop.<br>What is hadoop?<br>Hadoop is a open-souce software framework. containing storage part: Hadoop Distributed File System (HDFS) and a processing part called MapReduce.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/introduction/">introduction</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/">mapreduce</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Mapreduce-Start-from-Word-Count/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 Sean Han
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<link rel="stylesheet" href="/css/font-awesome.min.css">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>