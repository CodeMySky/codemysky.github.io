<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>CodeMySky&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="It&apos;s a blog to summarize my understanding in big data">
<meta property="og:type" content="website">
<meta property="og:title" content="CodeMySky&#39;s Blog">
<meta property="og:url" content="http://xiaohan.me/index.html">
<meta property="og:site_name" content="CodeMySky&#39;s Blog">
<meta property="og:description" content="It&apos;s a blog to summarize my understanding in big data">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CodeMySky&#39;s Blog">
<meta name="twitter:description" content="It&apos;s a blog to summarize my understanding in big data">
  
    <link rel="alternative" href="/atom.xml" title="CodeMySky&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/require-2.1.6,jquery-1.9.1.min.js"></script>
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="#" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Sean Han</a></h1>
		</hgroup>

		
		<p class="header-subtitle">My heart is in BIG DATA</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
							<li><a href="/2016/01/07/About-Me/">About Me</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/CodeMySky" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:hanxiaobow@gmail.com" title="mail">mail</a>
					        
								<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/codemysky" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/about-me/" style="font-size: 10px;">about-me</a> <a href="/tags/f-test/" style="font-size: 10px;">f-test</a> <a href="/tags/feature-extraction/" style="font-size: 10px;">feature-extraction</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hortonworks/" style="font-size: 10px;">hortonworks</a> <a href="/tags/introduction/" style="font-size: 10px;">introduction</a> <a href="/tags/knn/" style="font-size: 10px;">knn</a> <a href="/tags/mapreduce/" style="font-size: 16.67px;">mapreduce</a> <a href="/tags/predicting-poker-hands/" style="font-size: 20px;">predicting-poker-hands</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/random-forest/" style="font-size: 13.33px;">random-forest</a> <a href="/tags/sklearn/" style="font-size: 16.67px;">sklearn</a> <a href="/tags/statistics/" style="font-size: 10px;">statistics</a> <a href="/tags/t-test/" style="font-size: 10px;">t-test</a> <a href="/tags/z-test/" style="font-size: 10px;">z-test</a>
					</div>
				</section>
				

				

				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Sean Han</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/img/avatar.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Sean Han</h1>
			</hgroup>
			
			<p class="header-subtitle">My heart is in BIG DATA</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
					<li><a href="/2016/01/07/About-Me/">About Me</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/CodeMySky" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:hanxiaobow@gmail.com" title="mail">mail</a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/codemysky" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-测试中文" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/04/测试中文/" class="article-date">
  	<time datetime="2017-09-04T20:48:41.000Z" itemprop="datePublished">2017-09-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/04/测试中文/">测试中文</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我试试中文能不能写哦</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-test-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/09/04/test-1/" class="article-date">
  	<time datetime="2017-09-04T20:48:04.000Z" itemprop="datePublished">2017-09-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/04/test-1/">中文可以吗</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>杀杀杀</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-MapReduce-Train-Random-Forest-with-Python-and-Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/19/MapReduce-Train-Random-Forest-with-Python-and-Hadoop/" class="article-date">
  	<time datetime="2017-02-19T19:53:14.000Z" itemprop="datePublished">2017-02-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/19/MapReduce-Train-Random-Forest-with-Python-and-Hadoop/">MapReduce: Train Random Forest with Python and Hadoop</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Install-Hortonworks-Sandbox"><a href="#Install-Hortonworks-Sandbox" class="headerlink" title="Install Hortonworks Sandbox"></a>Install Hortonworks Sandbox</h2><p>Hortonworks sandbox provides a nice playground for hadoop beginners to test their big data application.</p>
<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">Windows and Linux: Install Virtual Box</a></li>
<li><a href="https://www.vmware.com/go/downloadfusion" target="_blank" rel="external">MAC: Install VMWare Fusion</a></li>
<li><a href="https://hortonworks.com/downloads/" target="_blank" rel="external">Install Hortonworks Sandbox</a></li>
<li><a href="http://hortonworks.com/hadoop-tutorial/learning-the-ropes-of-the-hortonworks-sandbox/" target="_blank" rel="external">Follow tutorial to setup environment and password</a></li>
<li>The python shipped with hortonworks is Python 2.6, which is really old.</li>
<li>Install Anaconda3 to upgrade python to Python 3.6 to default location /root/anaconda3</li>
<li><a href="https://www.continuum.io/downloads" target="_blank" rel="external">Anaconda</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bash Anaconda3-XXX-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<h2 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/root/anaconda3/bin/python</span></div><div class="line"><span class="comment"># Filename: forest_mapper.py</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> pickle</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DecisionNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, depth = <span class="number">0</span>, max_depth = <span class="number">-1</span>)</span>:</span></div><div class="line">        self._left_child = <span class="keyword">None</span></div><div class="line">        self._right_child = <span class="keyword">None</span></div><div class="line">        self._depth = depth</div><div class="line">        self._max_depth = max_depth</div><div class="line">        </div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_divide</span><span class="params">(self, data_set, column, condition)</span>:</span></div><div class="line">        <span class="keyword">if</span> isinstance(condition, str):</div><div class="line">            part_a = data_set[data_set[column] == condition]</div><div class="line">            part_b = data_set[data_set[column] != condition]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            part_a = data_set[data_set[column] &gt;= condition]</div><div class="line">            part_b = data_set[data_set[column] &lt; condition]</div><div class="line">        <span class="keyword">return</span> part_a, part_b</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_entropy</span><span class="params">(self, labels)</span>:</span></div><div class="line">        counts = labels.value_counts()</div><div class="line">        total = sum(counts)</div><div class="line">        entropy = -counts.map(<span class="keyword">lambda</span> c: (c/total) * math.log2(c/total)).sum()</div><div class="line">        <span class="keyword">return</span> entropy</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_entropy_sum</span><span class="params">(self, set_a, set_b)</span>:</span></div><div class="line">        size_a = set_a.shape[<span class="number">0</span>]</div><div class="line">        size_b = set_b.shape[<span class="number">0</span>]</div><div class="line">        total = size_a + size_b</div><div class="line">        total_entropy = size_a / total * self._entropy(set_a) + size_b / total * self._entropy(set_b)</div><div class="line">        <span class="keyword">return</span> total_entropy</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_information_gain</span><span class="params">(self,data_set, column, condition)</span>:</span></div><div class="line">        set_a, set_b = self._divide(data_set, column, condition)</div><div class="line">        gain = self._entropy(data_set.iloc[:, <span class="number">-1</span>]) - self._entropy_sum(set_a.iloc[:,<span class="number">-1</span>], set_b.iloc[:,<span class="number">-1</span>])</div><div class="line">        <span class="keyword">return</span> gain</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, data_set, selected_features = None)</span>:</span></div><div class="line">        <span class="keyword">if</span> selected_features <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            columns = data_set.columns.values.tolist()</div><div class="line">            selected_features = columns[:<span class="number">-1</span>]</div><div class="line">        </div><div class="line">        best_gain = <span class="number">0</span></div><div class="line">        best_split_col = <span class="keyword">None</span></div><div class="line">        best_split_value = <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> column_name <span class="keyword">in</span> selected_features:</div><div class="line">            current_column = data_set[column_name]</div><div class="line">            unique_values = current_column.unique().tolist()</div><div class="line">            <span class="keyword">for</span> value <span class="keyword">in</span> unique_values:</div><div class="line">                gain = self._information_gain(data_set, column_name, value)</div><div class="line">                <span class="keyword">if</span> gain &gt; best_gain:</div><div class="line">                    best_gain = gain</div><div class="line">                    best_split_col = column_name</div><div class="line">                    best_split_value = value</div><div class="line">                    </div><div class="line">        self._best_split_col = best_split_col</div><div class="line">        self._best_split_value = best_split_value</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> best_gain &gt; <span class="number">0</span> <span class="keyword">and</span> (self._max_depth == <span class="number">-1</span> <span class="keyword">or</span> self._depth &lt; self._max_depth):</div><div class="line">            set_a, set_b = self._divide(data_set, best_split_col, best_split_value)</div><div class="line">            self._left_child = DecisionNode(self._depth + <span class="number">1</span>, self._max_depth)</div><div class="line">            self._left_child.fit(set_a)</div><div class="line">            </div><div class="line">            self._right_child = DecisionNode(self._depth + <span class="number">1</span>, self._max_depth)</div><div class="line">            self._right_child.fit(set_b)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self._leaf_value = data_set.iloc[:,<span class="number">-1</span>].unique()[<span class="number">0</span>]</div><div class="line">            </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict_single</span><span class="params">(self, record)</span>:</span></div><div class="line">        <span class="keyword">if</span> self._left_child <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">and</span> self._right_child <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> self._leaf_value</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">if</span> isinstance(self._best_split_value, str):</div><div class="line">                go_left = record[self._best_split_col] == self._best_split_value</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                go_left = record[self._best_split_col] &gt;= self._best_split_value</div><div class="line">                </div><div class="line">            <span class="keyword">if</span> go_left:</div><div class="line">                <span class="keyword">return</span> self._left_child.predict_single(record)</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">return</span> self._right_child.predict_single(record)</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, data_set)</span>:</span></div><div class="line">        <span class="keyword">return</span> data_set.apply(self.predict_single, axis=<span class="number">1</span>)</div><div class="line">        </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></div><div class="line">        tree_str = <span class="string">'\t'</span> * self._depth + <span class="string">'&gt;'</span></div><div class="line">        <span class="keyword">if</span> self._left_child == <span class="keyword">None</span> <span class="keyword">and</span> self._right_child == <span class="keyword">None</span>:</div><div class="line">            tree_str += <span class="string">'LEAF: &#123;&#125;\n'</span>.format(self._leaf_value)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            tree_str += <span class="string">"Split &#123;&#125; on &#123;&#125;\n"</span>.format(self._best_split_col, self._best_split_value)</div><div class="line">            tree_str += str(self._left_child)</div><div class="line">            tree_str += str(self._right_child)</div><div class="line">        <span class="keyword">return</span> tree_str</div><div class="line"></div><div class="line"><span class="comment"># load dataset</span></div><div class="line">data_set =  pd.read_csv(<span class="string">'iris.data'</span>,  names=[<span class="string">'sepal_length'</span>, <span class="string">'sepal_width'</span>, <span class="string">'petal_length'</span>, <span class="string">'petal_width'</span>, <span class="string">'iris_type'</span>])</div><div class="line"><span class="comment"># input comes from STDIN (standard input)</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">    <span class="comment"># remove leading and trailing whitespace</span></div><div class="line">    line = line.strip()</div><div class="line"></div><div class="line">    <span class="comment"># generate a tree</span></div><div class="line">    selected_rows = np.random.choice(data_set.shape[<span class="number">0</span>] - <span class="number">1</span>, data_set.shape[<span class="number">0</span>] / <span class="number">3</span>)</div><div class="line">    selected_features = np.random.choice(data_set.columns.tolist()[:<span class="number">-1</span>], np.ceil(np.sqrt(data_set.shape[<span class="number">1</span>])), replace=<span class="keyword">False</span>)</div><div class="line">    decision_tree = DecisionNode()</div><div class="line">    decision_tree.fit(data_set.iloc[selected_rows,:], selected_features)</div><div class="line">    print(<span class="string">'&#123;&#125;'</span>.format(pickle.dumps(decision_tree)))</div></pre></td></tr></table></figure>
<h2 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h2><p>Code here is a modified version of reducer in <a href="http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/" target="_blank" rel="external">this blog</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/root/anaconda3/bin/python</span></div><div class="line"><span class="comment"># Filename: forest_reducer.py</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="comment"># input comes from STDIN</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</div><div class="line">    <span class="comment"># remove leading and trailing whitespace</span></div><div class="line">    line = line.strip()</div><div class="line"></div><div class="line">    print(<span class="string">'&#123;&#125;'</span>.format(line))</div></pre></td></tr></table></figure>
<h2 id="Test-Mapper-and-Reducer"><a href="#Test-Mapper-and-Reducer" class="headerlink" title="Test Mapper and Reducer"></a>Test Mapper and Reducer</h2><ul>
<li>Generate a forest_number.txt contains <code>n</code> line, where <code>n</code> is the number of trees you want to generate. Because we generate one tree per line, each mapper loads training data (iris) once, and randomly select feature and records for each tree.</li>
<li>If you want to generate 5 trees, forest_number.txt contains</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td></tr></table></figure>
<ul>
<li><p>Make mapper and reducer executable <figure class="highlight plain"><figcaption><span>+x forest_mapper.py forest_reducer.py```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- **Test your mapper and reducer locally** ```cat forest_number.txt | forest_mapper.py | sort | forest_reducer.py  ``` , this step is important because hadoop doesn&apos;t show the exact error output from python, so it&apos;s hard to debug python in hadoop.</div><div class="line">- Upload the txt into hdfs under `/demo/data`, using [Ambari file view](http://localhost:8080/#/main/views/FILES/1.0.0/AUTO_FILES_INSTANCE)</div><div class="line">- Test mapper and reducer using hadoop</div><div class="line"></div><div class="line">```bash</div><div class="line">hadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -file /root/forest_mapper.py -mapper forest_mapper.py -file /root/forest_reducer.py -reducer forest_reducer.py -file /root/iris.data -input /demo/data/forest_number.txt -output /demo/outputhadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar -file /root/forest_mapper.py -mapper forest_mapper.py -file /root/forest_reducer.py -reducer forest_reducer.py -file /root/iris.data -input /demo/data/forest_number.txt -output /demo/output</div></pre></td></tr></table></figure></p>
</li>
<li><p>After this step, generated trees should be stored in <code>/demo/output</code></p>
</li>
<li>Clean up the output folder after the experiment, this step is important because hadoop will not overwrite existing folder</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hdfs dfs -rm -r /demo/output</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Secret-Mission-Spy-in-the-Dark" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/22/Secret-Mission-Spy-in-the-Dark/" class="article-date">
  	<time datetime="2016-02-23T00:46:41.000Z" itemprop="datePublished">2016-02-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/22/Secret-Mission-Spy-in-the-Dark/">Secret Mission: Spy in the Dark</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Our hero, Tom, get a secret mission.<br>He need to determine what is a princess doing, to get the routine of her.<br>The data set looks like this.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/knn/">knn</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/">mapreduce</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Introduction-to-Inferential-Statistics" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/22/Introduction-to-Inferential-Statistics/" class="article-date">
  	<time datetime="2016-02-22T23:24:01.000Z" itemprop="datePublished">2016-02-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/22/Introduction-to-Inferential-Statistics/">Introduction to Inferential Statistics</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>As a data scientist, we have different methods to treat the data. But how can we know the whether our methods are doing good or our model is just guessing.<br>We can use a serious of test to decide whether our model is good or not including z-test, t-test and f-test.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/f-test/">f-test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/statistics/">statistics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/t-test/">t-test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/z-test/">z-test</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/02/22/Introduction-to-Inferential-Statistics/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Escaping-Predicting-Poker-Hands-Part-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/">Escaping: Predicting Poker Hands, Part 1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Our hero Tom, who used to be a data scientist, went on an adventure, predicting poker hands. He wanted to share his experience here and he hopes it will be helpful for you to learn how to explore the big data world.</p>
<p>In this beginner’s summary, Tom will first talk about some basic concepts of big data, including training sets, test sets. Tom then will talk about a random forest model and how to rate models in general. In the end, Tom will show why features are important to generate accurate results.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/predicting-poker-hands/">predicting-poker-hands</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-1/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-About-Me" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/About-Me/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/About-Me/">About Me</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’m a data scientist who is eager to dig truth out of data.<br>I’m a data scientist, but now I’m focusing on data visualization. I love the beauty of big data as well as good design. I love start-up feeling and eager to work as a team. I love entrepreneurship and leadership.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/about-me/">about-me</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/About-Me/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Escaping-Predicting-Poker-Hands-Part-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-2/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-2/">Escaping: Predicting Poker Hands, Part 2</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>We left Tom in a dangerous situation. To win the game, Tom needs to accurately predict poker hands. His predictions must rely on a training and test set. testing.123<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/predicting-poker-hands/">predicting-poker-hands</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sklearn/">sklearn</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-2/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Mapreduce-Start-from-Word-Count" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Mapreduce-Start-from-Word-Count/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Mapreduce-Start-from-Word-Count/">Mapreduce: Start from Word Count</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>As a fan of big data, the most basic concept of big data is hadoop.<br>What is hadoop?<br>Hadoop is a open-souce software framework. containing storage part: Hadoop Distributed File System (HDFS) and a processing part called MapReduce.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/introduction/">introduction</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/">mapreduce</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Mapreduce-Start-from-Word-Count/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Escaping-Predicting-Poker-Hands-Part-4" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-4/" class="article-date">
  	<time datetime="2016-01-17T23:11:08.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-4/">Escaping: Predicting Poker Hands, Part 4</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>New features are created to help improve performance.<br>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/feature-extraction/">feature-extraction</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/predicting-poker-hands/">predicting-poker-hands</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/random-forest/">random-forest</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sklearn/">sklearn</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/01/17/Escaping-Predicting-Poker-Hands-Part-4/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Sean Han
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<link rel="stylesheet" href="/css/font-awesome.min.css">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>

<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
</body>
</html>